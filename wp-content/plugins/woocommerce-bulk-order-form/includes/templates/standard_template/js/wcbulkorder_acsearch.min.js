jQuery(document).ready(function($){function e(){$("input.wcbulkorderproduct").autocomplete({source:function(e,r){$.getJSON(WCBulkOrder.url+"?callback=?&action="+t+"&category="+WCBulkOrder.category+"&included="+WCBulkOrder.included+"&excluded="+WCBulkOrder.excluded+"&_wpnonce="+WCBulkOrder.search_products_nonce,e,r)},select:function(e,t){var l=$(this),c=l.parent().siblings().find(".wcbulkorderquantity"),d=$(".wcbulkorderprice",l.parent().parent()),i=$(".wcbulkorderid",l.parent().parent());c.attr("placeholder",WCBulkOrder.enterquantity),i.val(t.item.id);var a=t.item.price.replace(/[^\d,._']/g,""),u=t.item.price.replace(/[^\d]/g,""),n=0;d.html('<span class="amount">'+t.item.price+"</span>"),d.find("span").text(t.item.price.replace(a,n.toFixed(2))),c.off("keyup").on("keyup",function(){if($this=$(this),c.val()>0)var e=parseInt(c.val())*u;else var e=0;var e=e/WCBulkOrder.decmultiple,e=e.toFixed(WCBulkOrder.num_decimals).toString().replace(".",WCBulkOrder.decimal_sep);d.find("span").text(t.item.price.replace(a,e)),r()}),l.on("autocompletechange change",function(){if($this=$(this),c.val()>0)var e=parseInt(c.val())*u;else var e=0;var e=e/WCBulkOrder.decmultiple,e=e.toFixed(WCBulkOrder.num_decimals).toString().replace(".",WCBulkOrder.decimal_sep);d.find("span").text(t.item.price.replace(a,e)),r()}).change()},minLength:WCBulkOrder.minLength,delay:WCBulkOrder.Delay,search:function(e,r){var t=$(this),l=$(".bulkorder_spinner",t.parent());l.show()},response:function(e,t){if($(".bulkorder_spinner").hide(),null==t.content||0===t.content){var l=$(this),c=l.parent().siblings().find(".wcbulkorderquantity"),d=$(".wcbulkorderprice",l.parent().parent());l.val(""),l.attr("placeholder",WCBulkOrder.noproductsfound),d.html(""),c.val(""),r()}},change:function(e,r){r.item||($(this).val(""),$(this).attr("placeholder",WCBulkOrder.selectaproduct))}}).each(function(){"true"===WCBulkOrder.display_images&&($(this).data("ui-autocomplete")._renderItem=function(e,r){return $("<li>").append("<a><img class='wcbof_autocomplete_img' src='"+r.imgsrc+"' />"+r.label+"</a>").appendTo(e)})}).click(function(){$(this).autocomplete("search","")})}function r(){var e=0,r=$this.parent().parent().find(".wcbulkorderprice");$(".wcbulkorderprice span.amount").each(function(){var t=$(this).text().replace(/[^\d]/g,"");t>0&&(e=e.toString().replace(/[^\d]/g,""),e=parseFloat(e)+parseFloat(t),e/=WCBulkOrder.decmultiple,e=e.toFixed(WCBulkOrder.num_decimals).toString().replace(".",WCBulkOrder.decimal_sep),$price=r.find("span").text().replace(/[^\d.,_']/g,""),$prices=r.find("span").text(),$this.parents().eq(4).find(".wcbulkorderpricetotal").text($prices.replace($price,e)))})}var t="bulk_order_product_search";for(WCBulkOrder.included=$("#BulkOrderForm").attr("included"),WCBulkOrder.excluded=$("#BulkOrderForm").attr("excluded"),WCBulkOrder.category=$("#BulkOrderForm").attr("category"),WCBulkOrder.decmultiple="1";WCBulkOrder.decmultiple.length<=WCBulkOrder.num_decimals;)WCBulkOrder.decmultiple+="0";$("#BulkOrderForm").on("click","input.wcbulkorderproduct",e()),$("button.wcbulkordernewrow").live("click",function(){var r=$("tr:last").html();return $("tbody.wcbulkorderformtbody").append('<tr class="wcbulkorderformtr"><td class="quick-order-table-item-cell name wcbulkorder-title"><i class="bulkorder_spinner"></i><input type="text" placeholder="Product name or SKU" name="wcbulkorderproduct[]" class="quick-order-table-item-cell-input wcbulkorderproduct" /></td><td class="quick-order-table-item-cell quantity wcbulkorder-quantity"><input type="text" name="wcbulkorderquantity[]" placeholder="Enter Quantity" class="quick-order-table-item-cell-input wcbulkorderquantity" /></td><input type="hidden" name="wcbulkorderid[]" class="wcbulkorderid" value="" /></tr>'),e(),!1}),$("button.wcbulkordernewrowprice").live("click",function(){var r=$("tr:last").html();return $("tbody.wcbulkorderformtbody").append('<tr class="wcbulkorderformtr"><td class="quick-order-table-item-cell name wcbulkorder-title"><i class="bulkorder_spinner"></i><input type="text" placeholder="Product name or SKU" name="wcbulkorderproduct[]" class="quick-order-table-item-cell-input wcbulkorderproduct" /></td><td class="quick-order-table-item-cell quantity wcbulkorder-quantity"><input type="text" name="wcbulkorderquantity[]" placeholder="Enter Quantity" class="quick-order-table-item-cell-input wcbulkorderquantity" /></td><td class="quick-order-table-item-cell price wcbulkorderprice"></td><input type="hidden" name="wcbulkorderid[]" class="wcbulkorderid" value="" /></tr>'),e(),!1})});