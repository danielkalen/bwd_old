function makeValid(e){e.addClass("valid").removeClass("invalid error")}function makeInvalid(e,t){e.addClass("invalid").removeClass("valid"),t&&e.addClass("invalid error")}function scrollUpIfNeeded(e){window.pageYOffset>e.offset().top&&$("html, body").animate({scrollTop:e.offset().top-70},300)}function setSectionHeight(e){e.hasClass("billing")&&(e.height(billingHeight),setTimeout(function(){billingHeight=e.height()},1e3)),e.hasClass("shipping")&&(e.height(shippingHeight),setTimeout(function(){shippingHeight=e.height()},1e3)),e.hasClass("payment")&&(e.height(paymentHeight),setTimeout(function(){paymentHeight=e.height()},1e3))}function billingFill(){var e=$$("#s-firstname").val(),t=$$("#s-lastname").val(),n=$$("#s-address").val(),i=$$("#s-apt").val(),r=$$("#s-country").val(),a=$$("#s-state").val(),o=$$("#s-city").val(),s=$$("#s-zip").val();$$("#b-firstname").val(e),$$("#b-lastname").val(t),$$("#b-address").val(n),$$("#b-apt").val(i),$$("#b-country").val(r),$$("#b-state").val(a),$$("#b-city").val(o),$$("#b-zip").val(s),$$("form.checkout").find(".checkout-section.shipping .fieldset").removeClass("invalid error").addClass("filled"),$$("#b-firstname, #b-lastname, #b-address, #b-apt, #b-country, #b-state, #b-city, #b-zip").change()}function billingEmpty(){$$("#b-firstname").val(""),$$("#b-lastname").val(""),$$("#b-address").val(""),$$("#b-apt").val(""),$$("#b-country").val(""),$$("#b-state").val(""),$$("#b-city").val(""),$$("#b-zip").val(""),$$("form.checkout").find(".checkout-section.shipping .fieldset").removeClass("invalid error filled")}function cardError(e,t,n){makeInvalid(n,!0),buttonError(t),n.one("keydown",function(){buttonClear()})}function initCard(){$("#payment").card({container:$(".card-wrapper"),numberInput:"#stripe-card-number",expiryInput:"#stripe-card-expiry",cvcInput:"#stripe-card-cvc",nameInput:"#stripe-card-name"})}!function(e){function t(t,i){var r=e.extend({},e.fn.accordion.defaults,i),d="";return t.each(function(){var t=e(this);n(t,r),"mouseenter"==r.bind&&t.bind("mouseenter",function(e){e.preventDefault(),a(t,r)}),"mouseover"==r.bind&&t.bind("mouseover",function(e){e.preventDefault(),a(t,r)}),"click"==r.bind&&t.bind("click",function(e){e.preventDefault(),a(t,r)}),"dblclick"==r.bind&&t.bind("dblclick",function(e){e.preventDefault(),a(t,r)}),id=t.attr("id"),o(r)&&l(r)?c(id,r)===!1?(t.addClass(r.cssClose),r.loadClose(t,r)):(t.addClass(r.cssOpen),r.loadOpen(t,r),d=id):id!=r.defaultOpen?(t.addClass(r.cssClose),r.loadClose(t,r)):(t.addClass(r.cssOpen),r.loadOpen(t,r),d=id)}),d.length>0&&o(r)?s(d,r):s("",r),t}function n(e,t){return e.data("accordion-opts",t)}function i(t){opened=e(document).find("."+t.cssOpen),e.each(opened,function(){e(this).addClass(t.cssClose).removeClass(t.cssOpen),t.animateClose(e(this),t)})}function r(e,t){i(t),e.removeClass(t.cssClose).addClass(t.cssOpen),t.animateOpen(e,t),o(t)&&(id=e.attr("id"),s(id,t))}function a(e,t){return e.hasClass(t.cssOpen)?(i(t),o(t)&&s("",t),!1):(i(t),r(e,t),!1)}function o(t){return e.cookie&&""!=t.cookieName?!0:!1}function s(t,n){return o(n)?void e.cookie(n.cookieName,t,n.cookieOptions):!1}function c(t,n){return o(n)&&l(n)?(cookie=unescape(e.cookie(n.cookieName)),cookie!=t?!1:!0):!1}function l(t){return o(t)?null==e.cookie(t.cookieName)?!1:!0:!1}e.fn.accordion=function(e){return!this||this.length<1?this:void t(this,e)},e.fn.accordion.defaults={cssClose:"accordion-close",cssOpen:"accordion-open",cookieName:"accordion",cookieOptions:{path:"/",expires:7,domain:"",secure:""},defaultOpen:"",speed:"slow",bind:"click",animateOpen:function(e,t){e.next().stop(!0,!0).slideDown(t.speed)},animateClose:function(e,t){e.next().stop(!0,!0).slideUp(t.speed)},loadOpen:function(e){e.next().show()},loadClose:function(e){e.next().hide()}}}(jQuery);var proceed,problem,$required,$currentStep,$previousStep,$lastField,billingSame,isOne,isTwo,isThree,billingHeight=$$(".checkout-section.billing").height(),shippingHeight=$$(".checkout-section.shipping").height(),paymentHeight=$$(".checkout-section.payment").height();$window.on("resize",function(){window.innerWidth<=920&&(billingHeight=$$(".checkout-section.billing").find(".checkout-section-wrap").height()+80,shippingHeight=$$(".checkout-section.shipping").find(".checkout-section-wrap").height()+80,paymentHeight=$$(".checkout-section.payment").find(".checkout-section-wrap").height()+80,setSectionHeights())}),$.fn.form=function(e,t){},$.fn.formValidate=function(){proceed=!1,problem=!1,$required=$$("form.checkout").find(".checkout-section.show").find(".fieldset.required"),billingSame=!$$("form.checkout").find(".fieldset.checkbox .input-button").hasClass("checked"),$required.each(function(){$this=$(this),$this.hasClass("valid")?$this.removeClass("error"):(problem=!0,$this.addClass("error"))}),proceed=problem?!1:!0},$.fn.formNext=function(){if($currentStep=$$("form.checkout").find(".checkout-section.show"),$currentStep.hasClass("payment"))var e=!0;else $$("form.checkout").formValidate();if(e){var t=$$("form.checkout").find(".checkout-section.billing").hasClass("show"),n;n=t&&billingSame?$currentStep.next().next():$currentStep.next(),$currentStep.removeClass("show").height(39),n.addClass("show"),setSectionHeight(this),scrollUpIfNeeded(n)}},$.fn.formOpen=function(){if(!this.hasClass("show")){var e=$$("form.checkout").find(".checkout-section.show");if(e.hasClass("payment"))var t=!0;else $$("form.checkout").formValidate();t||e.addClass("incomplete"),this.hasClass("shipping")&&billingSame?(e.hasClass("billing")||(e.removeClass("show").height(39),$$(".checkout-section.billing").addClass("show"),setSectionHeight($$(".checkout-section.billing"))),$$("#ship-to-different-address").addClass("highlight"),setTimeout(function(){$$("#ship-to-different-address").removeClass("highlight")},2e3)):(e.removeClass("show").height(39),this.addClass("show"),setSectionHeight(this),scrollUpIfNeeded(this))}},$.fn.formSubmit=function(){$$("form.checkout").formValidate(),$$(".cta-form-totals-item.shipping").hasClass("error")?buttonError("Shipping Zip Code"):proceed&&$$("#place_order").click()},$.fn.formBack=function(){if($currentStep=$$("form.checkout").find(".checkout-section.show"),e=$currentStep.prev(),$currentStep.hasClass("payment")&&billingSame)var e=$currentStep.prev().prev();$currentStep.removeClass("show").height(39),e.addClass("show"),setSectionHeight(e),scrollUpIfNeeded(e)},$.fn.formPrepare=function(){var e=$$("form.checkout").find(".checkout-section.billing"),t=$$("form.checkout").find(".checkout-section.shipping"),n=$$("form.checkout").find(".checkout-section.payment");e.addClass("show").height(billingHeight),t.height(39),n.height(39),$$("form.checkout").find(".fieldset").not(".radio, .checkbox").each(function(){$.fn.formPrepare.inputField($(this))}),$$("form.checkout").find(".fieldset.checkbox").each(function(){$.fn.formPrepare.checkboxField($(this))}),$$("form.checkout").find(".phone, .zip, .cardnumber, .cardcvc, .carddate").each(function(){$.fn.formPrepare.numberField($(this))}),$$("form.checkout").find(".email").each(function(){$.fn.formPrepare.emailField($(this))}),$$(".checkout-section").each(function(){$lastField=$(this).find(".fieldset").not(".checkbox").last(),$lastField.on("keydown",function(e){9===e.keyCode&&e.preventDefault()})}),$$("form.checkout input.input").each(function(){$this=$(this),$this.focus(function(){$(this).parent().addClass("focus")}),$this.blur(function(){$(this).parent().removeClass("focus")}),$this.keyup(function(){""===$(this).val()?$(this).parent().removeClass("filled"):$(this).parent().addClass("filled")}),$this.parent().hasClass("select")&&$this.change(function(){""!==$(this).val()?$(this).parent().addClass("filled"):$(this).parent().removeClass("filled")})})},$.fn.formPrepare.inputField=function(e){e.hasClass("required")?e.find(".input").not(".phone, .email, .cardcvc, .carddate").on("change keydown",function(){""===$(this).val()||null===$(this).val()?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}):e.addClass("valid")},$.fn.formPrepare.emailField=function(e){e.on("change keydown",function(){var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);""!==$(this).val()&&e.test($(this).val())?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))})},$.fn.formPrepare.checkboxField=function(e){e.find(".input-button").click(function(){$(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".input").prop("checked",!1),$(this).hasClass("checked")||$(this).siblings().hasClass("checked")?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))):($(this).addClass("checked"),$(this).find(".checkbox").prop("checked",!0),$(this).find(".input").prop("checked",!0),makeValid($(this).parents(".fieldset")))}),e.find("label").click(function(){$(this).parent().click()})},$.fn.formPrepare.numberField=function(e){e.keydown(function(e){e.ctrlKey||e.metaKey||normalKeycodes(e)||e.preventDefault()}),e.hasClass("phone")&&e.change(function(){""===$(this).val()||$(this).val().length<7?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}),e.hasClass("cardcvc")&&e.change(function(){""===$(this).val()||$(this).val().length<3?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}),e.hasClass("carddate")&&e.on("keydown keypress",function(e){var t=8===e.keyCode,n=9===e.keyCode,i=e.key;e.ctrlKey||e.metaKey||(!normalKeycodes(e)||e.keyCode>=48&&e.keyCode<=57)&&e.preventDefault(),mobile&&((48===e.keyCode||96===e.keyCode)&&(i=0),(49===e.keyCode||97===e.keyCode)&&(i=1),(50===e.keyCode||98===e.keyCode)&&(i=2),(51===e.keyCode||99===e.keyCode)&&(i=3),(52===e.keyCode||100===e.keyCode)&&(i=4),(53===e.keyCode||101===e.keyCode)&&(i=5),(54===e.keyCode||102===e.keyCode)&&(i=6),(55===e.keyCode||103===e.keyCode)&&(i=7),(56===e.keyCode||104===e.keyCode)&&(i=8),(57===e.keyCode||105===e.keyCode)&&(i=9));var r=$(this),a=r.val(),o=a.length;t?o>=3&&5>=o&&(a=a.substr(0,2)):(7>=o&&!isNaN(i)&&(0===o&&1>=i&&(a+=i),0===o&&i>1&&(a=a+"0"+i),1===o&&9>=i&&("0"===a.substr(0,1)?a+=i:2>=i&&(a+=i)),2===o&&(a=a+" / "+i),3===o&&(a=a+"/ "+i),4===o&&(a=a+" "+i),(5===o||6===o)&&(a+=i),o=a.length),o>=7?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))),r.val(a)})},$$("form.checkout").formPrepare(),$$("form.checkout .next").on("click",function(){$$("form.checkout").formNext()}),$$("form.checkout .submit").on("click",function(){$$("form.checkout").formSubmit()}),$$("form.checkout .back").on("click",function(){$$("form.checkout").formBack()}),$$(".checkout-section-title").on("click",function(){$(this).parent().formOpen()}),setTimeout(function(){$$(".checkout-section-fieldset-label").find("abbr").remove()},1e3),$$("body").on("updated_checkout",function(){initCard()}),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.card=e()}}(function(){var e,t,n;return function i(e,t,n){function r(o,s){if(!t[o]){if(!e[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return r(n?n:t)},l,l.exports,i,e,t,n)}return t[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){(function(){var $,e,t,n,i,r,a,o,s,c,l,d,u,h,f,p,m,v,g,y,C=[].slice,k=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};$=jQuery,$.payment={},$.payment.fn={},$.fn.payment=function(){var e,t;return t=arguments[0],e=2<=arguments.length?C.call(arguments,1):[],$.payment.fn[t].apply(this,e)},i=/(\d{1,4})/g,n=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:i,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:i,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:i,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:i,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:i,length:[16],cvcLength:[3],luhn:!0}],e=function(e){var t,i,r;for(e=(e+"").replace(/\D/g,""),i=0,r=n.length;r>i;i++)if(t=n[i],t.pattern.test(e))return t},t=function(e){var t,i,r;for(i=0,r=n.length;r>i;i++)if(t=n[i],t.type===e)return t},u=function(e){var t,n,i,r,a,o;for(i=!0,r=0,n=(e+"").split("").reverse(),a=0,o=n.length;o>a;a++)t=n[a],t=parseInt(t,10),(i=!i)&&(t*=2),t>9&&(t-=9),r+=t;return r%10===0},d=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)?!0:!1},h=function(e){return setTimeout(function(){var t,n;return t=$(e.currentTarget),n=t.val(),n=$.payment.formatCardNumber(n),t.val(n)})},o=function(t){var n,i,r,a,o,s,c;return r=String.fromCharCode(t.which),!/^\d+$/.test(r)||(n=$(t.currentTarget),c=n.val(),i=e(c+r),a=(c.replace(/\D/g,"")+r).length,s=16,i&&(s=i.length[i.length.length-1]),a>=s||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==c.length)?void 0:(o=i&&"amex"===i.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,o.test(c)?(t.preventDefault(),setTimeout(function(){return n.val(c+" "+r)})):o.test(c+r)?(t.preventDefault(),setTimeout(function(){return n.val(c+r+" ")})):void 0)},r=function(e){var t,n;return t=$(e.currentTarget),n=t.val(),8!==e.which||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==n.length?void 0:/\d\s$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\d\s$/,""))})):/\s\d?$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\s\d?$/,""))})):void 0},f=function(e){return setTimeout(function(){var t,n;return t=$(e.currentTarget),n=t.val(),n=$.payment.formatExpiry(n),t.val(n)})},s=function(e){var t,n,i;return n=String.fromCharCode(e.which),/^\d+$/.test(n)?(t=$(e.currentTarget),i=t.val()+n,/^\d$/.test(i)&&"0"!==i&&"1"!==i?(e.preventDefault(),setTimeout(function(){return t.val("0"+i+" / ")})):/^\d\d$/.test(i)?(e.preventDefault(),setTimeout(function(){return t.val(""+i+" / ")})):void 0):void 0},c=function(e){var t,n,i;return n=String.fromCharCode(e.which),/^\d+$/.test(n)?(t=$(e.currentTarget),i=t.val(),/^\d\d$/.test(i)?t.val(""+i+" / "):void 0):void 0},l=function(e){var t,n,i;return i=String.fromCharCode(e.which),"/"===i||" "===i?(t=$(e.currentTarget),n=t.val(),/^\d$/.test(n)&&"0"!==n?t.val("0"+n+" / "):void 0):void 0},a=function(e){var t,n;return t=$(e.currentTarget),n=t.val(),8!==e.which||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==n.length?void 0:/\s\/\s\d?$/.test(n)?(e.preventDefault(),setTimeout(function(){return t.val(n.replace(/\s\/\s\d?$/,""))})):void 0},g=function(e){var t;return e.metaKey||e.ctrlKey?!0:32===e.which?!1:0===e.which?!0:e.which<33?!0:(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))},m=function(t){var n,i,r,a;return n=$(t.currentTarget),r=String.fromCharCode(t.which),/^\d+$/.test(r)&&!d(n)?(a=(n.val()+r).replace(/\D/g,""),i=e(a),i?a.length<=i.length[i.length.length-1]:a.length<=16):void 0},v=function(e){var t,n,i;return t=$(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!d(t)?(i=t.val()+n,i=i.replace(/\D/g,""),i.length>6?!1:void 0):void 0},p=function(e){var t,n,i;return t=$(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!d(t)?(i=t.val()+n,i.length<=4):void 0},y=function(e){var t,i,r,a,o;return t=$(e.currentTarget),o=t.val(),a=$.payment.cardType(o)||"unknown",t.hasClass(a)?void 0:(i=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)r=n[e],i.push(r.type);return i}(),t.removeClass("unknown"),t.removeClass(i.join(" ")),t.addClass(a),t.toggleClass("identified","unknown"!==a),t.trigger("payment.cardType",a))},$.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",p),this},$.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",v),this.on("keypress",s),this.on("keypress",l),this.on("keypress",c),this.on("keydown",a),this.on("change",f),this.on("input",f),this},$.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this.on("keypress",o),this.on("keydown",r),this.on("keyup",y),this.on("paste",h),this.on("change",h),this.on("input",h),this.on("input",y),this},$.payment.fn.restrictNumeric=function(){return this.on("keypress",g),this},$.payment.fn.cardExpiryVal=function(){return $.payment.cardExpiryVal($(this).val())},$.payment.cardExpiryVal=function(e){var t,n,i,r;return e=e.replace(/\s/g,""),r=e.split("/",2),t=r[0],i=r[1],2===(null!=i?i.length:void 0)&&/^\d+$/.test(i)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),i=n+i),t=parseInt(t,10),i=parseInt(i,10),{month:t,year:i}},$.payment.validateCardNumber=function(t){var n,i;return t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)?(n=e(t),n?(i=t.length,k.call(n.length,i)>=0&&(n.luhn===!1||u(t))):!1):!1},$.payment.validateCardExpiry=function(e,t){var n,i,r;return"object"==typeof e&&"month"in e&&(r=e,e=r.month,t=r.year),e&&t?(e=$.trim(e),t=$.trim(t),/^\d+$/.test(e)&&/^\d+$/.test(t)&&e>=1&&12>=e?(2===t.length&&(t=70>t?"20"+t:"19"+t),4!==t.length?!1:(i=new Date(t,e),n=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>n)):!1):!1},$.payment.validateCardCVC=function(e,n){var i,r;return e=$.trim(e),/^\d+$/.test(e)?(i=t(n),null!=i?(r=e.length,k.call(i.cvcLength,r)>=0):e.length>=3&&e.length<=4):!1},$.payment.cardType=function(t){var n;return t?(null!=(n=e(t))?n.type:void 0)||null:null},$.payment.formatCardNumber=function(t){var n,i,r,a;return(n=e(t))?(r=n.length[n.length.length-1],t=t.replace(/\D/g,""),t=t.slice(0,r),n.format.global?null!=(a=t.match(n.format))?a.join(" "):void 0:(i=n.format.exec(t),null!=i?(i.shift(),i=$.grep(i,function(e){return e}),i.join(" ")):void 0)):t},$.payment.formatExpiry=function(e){var t,n,i,r;return(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",i=n[2]||"",r=n[3]||"",(r.length>0||i.length>0&&!/\ \/?\ ?/.test(i))&&(i=" / "),1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,i=" / "),t+i+r):""}}).call(this)},{}],2:[function(e,t,n){var $,i,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},a=[].slice;e("jquery.payment"),$=jQuery,$.card={},$.card.fn={},$.fn.card=function(e){return $.card.fn.construct.apply(this,e)},i=function(){function e(e,t){return this.options=$.extend(!0,{},this.defaults,t),$.extend(this.options.messages,$.card.messages),$.extend(this.options.values,$.card.values),this.$el=$(e),this.options.container?(this.$container=$(this.options.container),this.render(),this.attachHandlers(),void this.handleInitialValues()):void console.log("Please provide a container")}return e.prototype.cardTemplate='<div class="card-container">\n    <div class="card">\n        <div class="front">\n                <div class="card-logo visa">visa</div>\n                <div class="card-logo mastercard">MasterCard</div>\n                <div class="card-logo amex"></div>\n                <div class="card-logo discover">discover</div>\n            <div class="lower">\n                <div class="shiny"></div>\n                <div class="cvc display">{{cvc}}</div>\n                <div class="number display">{{number}}</div>\n                <div class="name display">{{name}}</div>\n                <div class="expiry display" data-before="{{monthYear}}" data-after="{{validDate}}">{{expiry}}</div>\n            </div>\n        </div>\n        <div class="back">\n            <div class="bar"></div>\n            <div class="cvc display">{{cvc}}</div>\n            <div class="shiny"></div>\n        </div>\n    </div>\n</div>',e.prototype.template=function(e,t){return e.replace(/\{\{(.*?)\}\}/g,function(e,n,i){return t[n]})},e.prototype.cardTypes=["maestro","dinersclub","laser","jcb","unionpay","discover","mastercard","amex","visa"],e.prototype.defaults={formatting:!0,formSelectors:{numberInput:'input[name="number"]',expiryInput:'input[name="expiry"]',cvcInput:'input[name="cvc"]',nameInput:'input[name="name"]'},cardSelectors:{cardContainer:".card-container",card:".card",numberDisplay:".number",expiryDisplay:".expiry",cvcDisplay:".cvc",nameDisplay:".name"},messages:{validDate:"valid\nthru",monthYear:"month/year"},values:{number:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull;",cvc:"&bull;&bull;&bull;",expiry:"&bull;&bull;/&bull;&bull;",name:"Full Name"},classes:{valid:"card-valid",invalid:"card-invalid"}},e.prototype.render=function(){var e,t;return this.$container.append(this.template(this.cardTemplate,$.extend({},this.options.messages,this.options.values))),$.each(this.options.cardSelectors,function(e){return function(t,n){return e["$"+t]=e.$container.find(n)}}(this)),$.each(this.options.formSelectors,function(e){return function(t,n){var i;return i=e.options[t]?$(e.options[t]):e.$el.find(n),i.length||console.error("Card can't find a "+t+" in your form."),e["$"+t]=i}}(this)),this.options.formatting&&(this.$numberInput.payment("formatCardNumber"),this.$cvcInput.payment("formatCardCVC"),1===this.$expiryInput.length&&this.$expiryInput.payment("formatCardExpiry")),this.options.width&&(e=parseInt(this.$cardContainer.css("width")),this.$cardContainer.css("transform","scale("+this.options.width/e+")")),("undefined"!=typeof navigator&&null!==navigator?navigator.userAgent:void 0)&&(t=navigator.userAgent.toLowerCase(),-1!==t.indexOf("safari")&&-1===t.indexOf("chrome")&&this.$card.addClass("safari")),new Function("/*@cc_on return @_jscript_version; @*/")()?this.$card.addClass("ie-10"):void 0},e.prototype.attachHandlers=function(){var e;return this.$numberInput.bindVal(this.$numberDisplay,{fill:!1,filters:this.validToggler("cardNumber")}).on("payment.cardType",this.handle("setCardType")),e=[function(e){return e.replace(/(\s+)/g,"")}],1===this.$expiryInput.length&&(e.push(this.validToggler("cardExpiry")),this.$expiryInput.on("keydown",this.handle("captureTab"))),this.$expiryInput.bindVal(this.$expiryDisplay,{join:function(e){return 2===e[0].length||e[1]?"/":""},filters:e}),this.$cvcInput.bindVal(this.$cvcDisplay,{filters:this.validToggler("cardCVC")}).on("focus",this.handle("flipCard")).on("blur",this.handle("flipCard")),this.$nameInput.bindVal(this.$nameDisplay,{fill:!1,filters:this.validToggler("cardHolderName"),join:" "}).on("keydown",this.handle("captureName"))},e.prototype.handleInitialValues=function(){return $.each(this.options.formSelectors,function(e){return function(t,n){var i;return i=e["$"+t],i.val()?(i.trigger("paste"),setTimeout(function(){return i.trigger("keyup")})):void 0}}(this))},e.prototype.handle=function(e){return function(t){return function(n){var i,r;return i=$(n.currentTarget),r=Array.prototype.slice.call(arguments),r.unshift(i),t.handlers[e].apply(t,r)}}(this)},e.prototype.validToggler=function(e){var t;return"cardExpiry"===e?t=function(e){var t;return t=$.payment.cardExpiryVal(e),$.payment.validateCardExpiry(t.month,t.year)}:"cardCVC"===e?t=function(e){return function(t){return $.payment.validateCardCVC(t,e.cardType)}}(this):"cardNumber"===e?t=function(e){return $.payment.validateCardNumber(e)}:"cardHolderName"===e&&(t=function(e){return""!==e}),function(e){return function(n,i,r){var a;return a=t(n),e.toggleValidClass(i,a),e.toggleValidClass(r,a),n}}(this)},e.prototype.toggleValidClass=function(e,t){return e.toggleClass(this.options.classes.valid,t),e.toggleClass(this.options.classes.invalid,!t)},e.prototype.handlers={setCardType:function(e,t,n){return this.$card.hasClass(n)?void 0:(this.$card.removeClass("unknown"),this.$card.removeClass(this.cardTypes.join(" ")),this.$card.addClass(n),this.$card.toggleClass("identified","unknown"!==n),this.cardType=n)},flipCard:function(e,t){return this.$card.toggleClass("flipped")},captureTab:function(e,t){var n,i;return n=t.keyCode||t.which,9===n&&!t.shiftKey&&(i=e.payment("cardExpiryVal"),i.month||i.year)?$.payment.validateCardExpiry(i.month,i.year)?void 0:t.preventDefault():void 0},captureName:function(e,t){var n,i,a;return a=t.which||t.keyCode,i=[48,49,50,51,52,53,54,55,56,57,106,107,109,110,111,186,187,188,189,190,191,192,219,220,221,222],n=[189,109,190,110,222],-1===i.indexOf(a)||!t.shiftKey&&r.call(n,a)>=0?void 0:t.preventDefault()}},$.fn.bindVal=function(e,t){var n,i,r,a,o;return null==t&&(t={}),t.fill=t.fill||!1,t.filters=t.filters||[],t.filters instanceof Array||(t.filters=[t.filters]),t.join=t.join||"","function"!=typeof t.join&&(r=t.join,t.join=function(){return r}),n=$(this),o=function(){var t,n,r;for(r=[],i=t=0,n=e.length;n>t;i=++t)a=e[i],r.push(e.eq(i).text());return r}(),n.on("focus",function(){return e.addClass("focused")}),n.on("blur",function(){return e.removeClass("focused")}),n.on("keyup change paste",function(r){var s,c,l,d,u,h,f,p,m,v;for(d=n.map(function(){return $(this).val()}).get(),c=t.join(d),d=d.join(c),d===c&&(d=""),m=t.filters,u=0,f=m.length;f>u;u++)s=m[u],d=s(d,n,e);for(v=[],i=h=0,p=e.length;p>h;i=++h)a=e[i],l=t.fill?d+o[i].substring(d.length):d||o[i],v.push(e.eq(i).text(l));return v}),n},e}(),$.fn.extend({card:function(){var e,t;return t=arguments[0],e=2<=arguments.length?a.call(arguments,1):[],this.each(function(){var n,r;return n=$(this),r=n.data("card"),r||n.data("card",r=new i(this,t)),"string"==typeof t?r[t].apply(r,e):void 0})}})},{"jquery.payment":1}]},{},[2])(2)});