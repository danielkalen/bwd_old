function fieldEvents(){$$(".userpro-form-fieldset").each(function(){$this=$(this),$this.hasClass("checkbox")?$.fn.formPrepare.checkboxField($this):attachEvents($this.find("input"))}),$$(".userpro-form-actions-button").on("click",function(){$(this).siblings(".userpro-form-actions-button-hidden").click()})}function resetFormButtonsEvents(){$$(".userpro-form-actions-button.change").on("click",function(){$(this).siblings(".userpro-form-actions-button-hidden.change").click()}),$$(".userpro-form-actions-button.request").on("click",function(){$(this).siblings(".userpro-form-actions-button-hidden.request").click()})}function attachEvents(e){e.focus(function(){$(this).parent().addClass("focus")}),e.blur(function(){$(this).parent().removeClass("focus")}),e.keyup(function(){""===$(this).val()?$(this).parent().removeClass("filled"):$(this).parent().addClass("filled")}),e.parent().hasClass("select")&&e.change(function(){""!==$(this).val()?$(this).parent().addClass("filled"):$(this).parent().removeClass("filled")}),"checkbox"!==e.attr("type")&&""!==e.val()&&e.parent().addClass("filled valid")}function makeValid(e){e.addClass("valid").removeClass("invalid error")}function makeInvalid(e,t){e.addClass("invalid").removeClass("valid"),t&&e.addClass("invalid error")}function scrollUpIfNeeded(e){window.pageYOffset>e.offset().top&&$("html, body").animate({scrollTop:e.offset().top-70},300)}function setSectionHeight(e){e.hasClass("billing")&&(e.height(billingHeight),billingHeight=$$(".checkout-section.billing").find(".checkout-section-wrap").height()+80),e.hasClass("shipping")&&(e.height(shippingHeight),shippingHeight=$$(".checkout-section.shipping").find(".checkout-section-wrap").height()+80),e.hasClass("payment")&&(e.height(paymentHeight),paymentHeight=$$(".checkout-section.payment").find(".checkout-section-wrap").height()+80)}function billingFill(){var e=$$("#s-firstname").val(),t=$$("#s-lastname").val(),i=$$("#s-address").val(),s=$$("#s-apt").val(),n=$$("#s-country").val(),o=$$("#s-state").val(),a=$$("#s-city").val(),c=$$("#s-zip").val();$$("#b-firstname").val(e),$$("#b-lastname").val(t),$$("#b-address").val(i),$$("#b-apt").val(s),$$("#b-country").val(n),$$("#b-state").val(o),$$("#b-city").val(a),$$("#b-zip").val(c),$$("form.checkout").find(".checkout-section.shipping .fieldset").removeClass("invalid error").addClass("filled"),$$("#b-firstname, #b-lastname, #b-address, #b-apt, #b-country, #b-state, #b-city, #b-zip").change()}function billingEmpty(){$$("#b-firstname").val(""),$$("#b-lastname").val(""),$$("#b-address").val(""),$$("#b-apt").val(""),$$("#b-country").val(""),$$("#b-state").val(""),$$("#b-city").val(""),$$("#b-zip").val(""),$$("form.checkout").find(".checkout-section.shipping .fieldset").removeClass("invalid error filled")}function cardError(e,t,i){makeInvalid(i,!0),buttonError(t),i.one("keydown",function(){buttonClear()})}fieldEvents();var proceed,problem,$required,$currentStep,$previousStep,$lastField,billingSame,isOne,isTwo,isThree,billingHeight=$$(".checkout-section.billing").height(),shippingHeight=$$(".checkout-section.shipping").height(),paymentHeight=$$(".checkout-section.payment").height();$window.on("resize",function(){window.innerWidth<=920&&(billingHeight=$$(".checkout-section.billing").find(".checkout-section-wrap").height()+80,shippingHeight=$$(".checkout-section.shipping").find(".checkout-section-wrap").height()+80,paymentHeight=$$(".checkout-section.payment").find(".checkout-section-wrap").height()+80,setSectionHeights())}),$.fn.form=function(e,t){},$.fn.formPrepare=function(){var e=$$("form.checkout").find(".checkout-section.billing"),t=$$("form.checkout").find(".checkout-section.shipping"),i=$$("form.checkout").find(".checkout-section.payment");e.addClass("show").height(billingHeight),t.height(39),i.height(39),$$("form.checkout").find(".fieldset").not(".radio, .checkbox").each(function(){$.fn.formPrepare.inputField($(this))}),$$("form.checkout").find(".fieldset.checkbox").each(function(){$.fn.formPrepare.checkboxField($(this))}),$$("form.checkout").find(".phone, .zip, .cardnumber, .cardcvc, .carddate").each(function(){$.fn.formPrepare.numberField($(this))}),$$("form.checkout").find(".email").each(function(){$.fn.formPrepare.emailField($(this))}),$$(".checkout-section").each(function(){$lastField=$(this).find(".fieldset").not(".checkbox").last(),$lastField.on("keydown",function(e){9===e.keyCode&&e.preventDefault()})}),$$("form.checkout .input").each(function(){$this=$(this),attachEvents($this)})},$.fn.formValidate=function(){proceed=!1,problem=!1,$required=$$("form.checkout").find(".checkout-section.show").find(".fieldset.required"),billingSame=$$("form.checkout").find(".billing .fieldset.checkbox .input-button").hasClass("checked"),$required.each(function(){$this=$(this),$this.hasClass("valid")?$this.removeClass("error"):(problem=!0,$this.addClass("error"))}),proceed=problem?!1:!0},$.fn.formNext=function(){if($currentStep=$$("form.checkout").find(".checkout-section.show"),$currentStep.hasClass("payment")?proceed=!0:$$("form.checkout").formValidate(),proceed){var e=$$("form.checkout").find(".checkout-section.billing").hasClass("show"),t;t=e&&billingSame?$currentStep.next().next():$currentStep.next(),$currentStep.removeClass("show").height(39),t.addClass("show"),setSectionHeight(t),scrollUpIfNeeded(t)}},$.fn.formOpen=function(){if(!this.hasClass("show")){var e=$$("form.checkout").find(".checkout-section.show");e.hasClass("payment")?proceed=!0:$$("form.checkout").formValidate(),proceed||e.addClass("incomplete"),this.hasClass("shipping")&&billingSame?(e.hasClass("billing")||(e.removeClass("show").height(39),$$(".checkout-section.billing").addClass("show"),setSectionHeight($$(".checkout-section.billing"))),$$("#ship-to-different-address").addClass("highlight"),setTimeout(function(){$$("#ship-to-different-address").removeClass("highlight")},2e3)):(e.removeClass("show").height(39),this.addClass("show"),setSectionHeight(this),scrollUpIfNeeded(this))}},$.fn.formSubmit=function(){$$("form.checkout").formValidate(),proceed&&$$("#place_order").click()},$.fn.formBack=function(){if($currentStep=$$("form.checkout").find(".checkout-section.show"),e=$currentStep.prev(),$currentStep.hasClass("payment")&&billingSame)var e=$currentStep.prev().prev();$currentStep.removeClass("show").height(39),e.addClass("show"),setSectionHeight(e),scrollUpIfNeeded(e)},$.fn.formPrepare.inputField=function(e){e.hasClass("required")?e.find(".input").not(".phone, .email, .cardcvc, .carddate").on("change keydown",function(){""===$(this).val()||null===$(this).val()?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}):e.addClass("valid")},$.fn.formPrepare.emailField=function(e){e.on("change keydown",function(){var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);""!==$(this).val()&&e.test($(this).val())?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))})},$.fn.formPrepare.checkboxField=function(e){e.find(".input-button").click(function(){$(this).hasClass("checked")?($(this).removeClass("checked"),$(this).find(".input").prop("checked",!1),$(this).hasClass("checked")||$(this).siblings().hasClass("checked")?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))):($(this).addClass("checked"),$(this).find(".checkbox").prop("checked",!0),$(this).find(".input").prop("checked",!0),makeValid($(this).parents(".fieldset")))}),e.find("label").click(function(){$(this).parent().click()})},$.fn.formPrepare.numberField=function(e){e.keydown(function(e){e.ctrlKey||e.metaKey||normalKeycodes(e)||e.preventDefault()}),e.hasClass("phone")&&e.change(function(){""===$(this).val()||$(this).val().length<7?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}),e.hasClass("cardcvc")&&e.change(function(){""===$(this).val()||$(this).val().length<3?makeInvalid($(this).parents(".fieldset")):makeValid($(this).parents(".fieldset"))}),e.hasClass("carddate")&&e.on("keydown keypress",function(e){var t=8===e.keyCode,i=9===e.keyCode,s=e.key;e.ctrlKey||e.metaKey||(!normalKeycodes(e)||e.keyCode>=48&&e.keyCode<=57)&&e.preventDefault(),mobile&&((48===e.keyCode||96===e.keyCode)&&(s=0),(49===e.keyCode||97===e.keyCode)&&(s=1),(50===e.keyCode||98===e.keyCode)&&(s=2),(51===e.keyCode||99===e.keyCode)&&(s=3),(52===e.keyCode||100===e.keyCode)&&(s=4),(53===e.keyCode||101===e.keyCode)&&(s=5),(54===e.keyCode||102===e.keyCode)&&(s=6),(55===e.keyCode||103===e.keyCode)&&(s=7),(56===e.keyCode||104===e.keyCode)&&(s=8),(57===e.keyCode||105===e.keyCode)&&(s=9));var n=$(this),o=n.val(),a=o.length;t?a>=3&&5>=a&&(o=o.substr(0,2)):(7>=a&&!isNaN(s)&&(0===a&&1>=s&&(o+=s),0===a&&s>1&&(o=o+"0"+s),1===a&&9>=s&&("0"===o.substr(0,1)?o+=s:2>=s&&(o+=s)),2===a&&(o=o+" / "+s),3===a&&(o=o+"/ "+s),4===a&&(o=o+" "+s),(5===a||6===a)&&(o+=s),a=o.length),a>=7?makeValid($(this).parents(".fieldset")):makeInvalid($(this).parents(".fieldset"))),n.val(o)})};